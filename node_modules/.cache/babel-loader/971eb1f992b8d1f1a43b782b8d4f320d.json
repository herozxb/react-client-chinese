{"ast":null,"code":"import _taggedTemplateLiteral from \"/Users/empzxb/Documents/deepLearning/app/react-client/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nimport _slicedToArray from \"/Users/empzxb/Documents/deepLearning/app/react-client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/empzxb/Documents/deepLearning/app/react-client/src/components/DeleteButton.js\";\n\nfunction _templateObject2() {\n  const data = _taggedTemplateLiteral([\"\\n  mutation deleteComment($postId: ID!, $commentId: ID!) {\\n    deleteComment(postId: $postId, commentId: $commentId) {\\n      id\\n      comments {\\n        id\\n        username\\n        createdAt\\n        body\\n      }\\n      commentCount\\n    }\\n  }\\n\"]);\n\n  _templateObject2 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  const data = _taggedTemplateLiteral([\"\\n  mutation deletePost($postId: ID!) {\\n    deletePost(postId: $postId)\\n  }\\n\"]);\n\n  _templateObject = function () {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState } from 'react';\nimport gql from 'graphql-tag';\nimport { useMutation } from '@apollo/react-hooks';\nimport { Button, Confirm, Icon } from 'semantic-ui-react';\nimport { FETCH_POSTS_QUERY } from '../util/graphql';\nimport MyPopup from '../util/MyPopup';\n\nfunction DeleteButton({\n  postId,\n  commentId,\n  callback\n}) {\n  const _useState = useState(false),\n        _useState2 = _slicedToArray(_useState, 2),\n        confirmOpen = _useState2[0],\n        setConfirmOpen = _useState2[1];\n\n  const mutation = commentId ? DELETE_COMMENT_MUTATION : DELETE_POST_MUTATION;\n\n  const _useMutation = useMutation(mutation, {\n    update(proxy) {\n      setConfirmOpen(false);\n\n      if (!commentId) {\n        const data = proxy.readQuery({\n          query: FETCH_POSTS_QUERY\n        });\n        data.getPosts = data.getPosts.filter(p => p.id !== postId);\n        proxy.writeQuery({\n          query: FETCH_POSTS_QUERY,\n          data\n        });\n      }\n\n      if (callback) callback();\n    },\n\n    variables: {\n      postId,\n      commentId\n    }\n  }),\n        _useMutation2 = _slicedToArray(_useMutation, 1),\n        deletePostOrMutation = _useMutation2[0];\n\n  return React.createElement(React.Fragment, null, React.createElement(MyPopup, {\n    content: commentId ? 'Delete comment' : 'Delete post',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33\n    },\n    __self: this\n  }, React.createElement(Button, {\n    as: \"div\",\n    color: \"red\",\n    floated: \"right\",\n    onClick: () => setConfirmOpen(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34\n    },\n    __self: this\n  }, React.createElement(Icon, {\n    name: \"trash\",\n    style: {\n      margin: 0\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40\n    },\n    __self: this\n  }))), React.createElement(Confirm, {\n    open: confirmOpen,\n    onCancel: () => setConfirmOpen(false),\n    onConfirm: deletePostOrMutation,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43\n    },\n    __self: this\n  }));\n}\n\nconst DELETE_POST_MUTATION = gql(_templateObject());\nconst DELETE_COMMENT_MUTATION = gql(_templateObject2());\nexport default DeleteButton;","map":{"version":3,"sources":["/Users/empzxb/Documents/deepLearning/app/react-client/src/components/DeleteButton.js"],"names":["React","useState","gql","useMutation","Button","Confirm","Icon","FETCH_POSTS_QUERY","MyPopup","DeleteButton","postId","commentId","callback","confirmOpen","setConfirmOpen","mutation","DELETE_COMMENT_MUTATION","DELETE_POST_MUTATION","update","proxy","data","readQuery","query","getPosts","filter","p","id","writeQuery","variables","deletePostOrMutation","margin"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,OAAOC,GAAP,MAAgB,aAAhB;AACA,SAASC,WAAT,QAA4B,qBAA5B;AACA,SAASC,MAAT,EAAiBC,OAAjB,EAA0BC,IAA1B,QAAsC,mBAAtC;AAEA,SAASC,iBAAT,QAAkC,iBAAlC;AACA,OAAOC,OAAP,MAAoB,iBAApB;;AAEA,SAASC,YAAT,CAAsB;AAAEC,EAAAA,MAAF;AAAUC,EAAAA,SAAV;AAAqBC,EAAAA;AAArB,CAAtB,EAAuD;AAAA,oBACfX,QAAQ,CAAC,KAAD,CADO;AAAA;AAAA,QAC9CY,WAD8C;AAAA,QACjCC,cADiC;;AAGrD,QAAMC,QAAQ,GAAGJ,SAAS,GAAGK,uBAAH,GAA6BC,oBAAvD;;AAHqD,uBAKtBd,WAAW,CAACY,QAAD,EAAW;AACnDG,IAAAA,MAAM,CAACC,KAAD,EAAQ;AACZL,MAAAA,cAAc,CAAC,KAAD,CAAd;;AACA,UAAI,CAACH,SAAL,EAAgB;AACd,cAAMS,IAAI,GAAGD,KAAK,CAACE,SAAN,CAAgB;AAC3BC,UAAAA,KAAK,EAAEf;AADoB,SAAhB,CAAb;AAGAa,QAAAA,IAAI,CAACG,QAAL,GAAgBH,IAAI,CAACG,QAAL,CAAcC,MAAd,CAAsBC,CAAD,IAAOA,CAAC,CAACC,EAAF,KAAShB,MAArC,CAAhB;AACAS,QAAAA,KAAK,CAACQ,UAAN,CAAiB;AAAEL,UAAAA,KAAK,EAAEf,iBAAT;AAA4Ba,UAAAA;AAA5B,SAAjB;AACD;;AACD,UAAIR,QAAJ,EAAcA,QAAQ;AACvB,KAXkD;;AAYnDgB,IAAAA,SAAS,EAAE;AACTlB,MAAAA,MADS;AAETC,MAAAA;AAFS;AAZwC,GAAX,CALW;AAAA;AAAA,QAK9CkB,oBAL8C;;AAsBrD,SACE,0CACE,oBAAC,OAAD;AAAS,IAAA,OAAO,EAAElB,SAAS,GAAG,gBAAH,GAAsB,aAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,MAAD;AACE,IAAA,EAAE,EAAC,KADL;AAEE,IAAA,KAAK,EAAC,KAFR;AAGE,IAAA,OAAO,EAAC,OAHV;AAIE,IAAA,OAAO,EAAE,MAAMG,cAAc,CAAC,IAAD,CAJ/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAME,oBAAC,IAAD;AAAM,IAAA,IAAI,EAAC,OAAX;AAAmB,IAAA,KAAK,EAAE;AAAEgB,MAAAA,MAAM,EAAE;AAAV,KAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANF,CADF,CADF,EAWE,oBAAC,OAAD;AACE,IAAA,IAAI,EAAEjB,WADR;AAEE,IAAA,QAAQ,EAAE,MAAMC,cAAc,CAAC,KAAD,CAFhC;AAGE,IAAA,SAAS,EAAEe,oBAHb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAXF,CADF;AAmBD;;AAED,MAAMZ,oBAAoB,GAAGf,GAAH,mBAA1B;AAMA,MAAMc,uBAAuB,GAAGd,GAAH,oBAA7B;AAeA,eAAeO,YAAf","sourcesContent":["import React, { useState } from 'react';\nimport gql from 'graphql-tag';\nimport { useMutation } from '@apollo/react-hooks';\nimport { Button, Confirm, Icon } from 'semantic-ui-react';\n\nimport { FETCH_POSTS_QUERY } from '../util/graphql';\nimport MyPopup from '../util/MyPopup';\n\nfunction DeleteButton({ postId, commentId, callback }) {\n  const [confirmOpen, setConfirmOpen] = useState(false);\n\n  const mutation = commentId ? DELETE_COMMENT_MUTATION : DELETE_POST_MUTATION;\n\n  const [deletePostOrMutation] = useMutation(mutation, {\n    update(proxy) {\n      setConfirmOpen(false);\n      if (!commentId) {\n        const data = proxy.readQuery({\n          query: FETCH_POSTS_QUERY\n        });\n        data.getPosts = data.getPosts.filter((p) => p.id !== postId);\n        proxy.writeQuery({ query: FETCH_POSTS_QUERY, data });\n      }\n      if (callback) callback();\n    },\n    variables: {\n      postId,\n      commentId\n    }\n  });\n  return (\n    <>\n      <MyPopup content={commentId ? 'Delete comment' : 'Delete post'}>\n        <Button\n          as=\"div\"\n          color=\"red\"\n          floated=\"right\"\n          onClick={() => setConfirmOpen(true)}\n        >\n          <Icon name=\"trash\" style={{ margin: 0 }} />\n        </Button>\n      </MyPopup>\n      <Confirm\n        open={confirmOpen}\n        onCancel={() => setConfirmOpen(false)}\n        onConfirm={deletePostOrMutation}\n      />\n    </>\n  );\n}\n\nconst DELETE_POST_MUTATION = gql`\n  mutation deletePost($postId: ID!) {\n    deletePost(postId: $postId)\n  }\n`;\n\nconst DELETE_COMMENT_MUTATION = gql`\n  mutation deleteComment($postId: ID!, $commentId: ID!) {\n    deleteComment(postId: $postId, commentId: $commentId) {\n      id\n      comments {\n        id\n        username\n        createdAt\n        body\n      }\n      commentCount\n    }\n  }\n`;\n\nexport default DeleteButton;\n"]},"metadata":{},"sourceType":"module"}